
<!doctype html>
<html lang="uz" class="no-js">
  <head>
    
  <script src="https://telegram.org/js/telegram-web-app.js?35"></script>
    <script type="text/javascript">
      const webapp = window.Telegram.WebApp;
      webapp.ready();
      webapp.expand();
      const initData = webapp.initDataUnsafe;
      if (window.location.pathname === "/aiogram-3-guide/" && Object.hasOwn(initData, 'auth_date')) {
        if (initData.start_param) {
          let additionalParam = '';
          switch (initData.start_param) {
            case 'quickstart':
            case 'messages':
            case 'buttons':
            case 'routers':
            case 'special-updates':
            case 'fsm':
            case 'inline-mode':
              additionalParam = initData.start_param;
              break;
            case 'filters':
              additionalParam = 'filters-and-middlewares/#filters';
              break
            case 'middlewares':
              additionalParam = 'filters-and-middlewares/#middlewares';
              break
            case 'magic-filter':
            case 'magic':
              additionalParam = 'filters-and-middlewares/#magic-filters';
              break
            case 'entities':
              additionalParam = 'messages/#message-entities';
              break;
            case 'escaping':
              additionalParam = 'messages/#input-escaping';
              break;
            case 'keep-formatting':
              additionalParam = 'messages/#keep-formatting';
              break
            case 'send-files':
            case 'upload':
              additionalParam = 'messages/#uploading-media';
              break;
            case 'download-files':
            case 'download':
              additionalParam = 'messages/#downloading-media';
              break;
            case 'hide-image':
              additionalParam = 'messages/#bonus';
              break
            case 'callback-factory':
              additionalParam = 'buttons/#callback-factory';
              break
            case 'my-chat-member':
              additionalParam = 'special-updates/#my-chat-member';
              break
            case 'chat-member':
              additionalParam = 'special-updates/#chat-member';
              break
            default:
              additionalParam = '/';
          }
          window.location.href = (`${window.location.origin}${window.location.pathname}${additionalParam}`);
        }
      }
  </script>

  
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Aiogram bilan tanishish">
      
      
        <meta name="author" content="MasterGroosha">
      
      
        <link rel="canonical" href="https://mastergroosha.github.io/aiogram-3-guide/quickstart/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../messages/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.25">
    

    
      
        <title>Aiogram bilan tanishish - Telegram botlarini aiogram 3.x bilan yozish</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
  
    
  

  
  
    
  

  <meta property="og:type" content="website" />
  <meta property="og:title" content="Telegram botlarini aiogram 3.x bilan yozish" />
  <meta property="og:description" content="Aiogram bilan tanishish" />
  <meta property="og:url" content="https://mastergroosha.github.io/aiogram-3-guide/quickstart/" />
  <meta property="og:image" content="https://mastergroosha.github.io/aiogram-3-guide/images/social.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="512" />
  <meta property="og:image:height" content="512" />

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://mastergroosha.github.io/aiogram-3-guide/quickstart/">
  <meta name="twitter:title" content="Telegram botlarini aiogram 3.x bilan yozish">
  <meta name="twitter:description" content="Aiogram bilan tanishish">
  <meta name="twitter:image" content="https://mastergroosha.github.io/aiogram-3-guide/images/social.png">


  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#aiogram-bilan-tanishish" class="md-skip">
          Tarkibga o'tish
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Sarlavha">
    <a href=".." title="Telegram botlarini aiogram 3.x bilan yozish" class="md-header__button md-logo" aria-label="Telegram botlarini aiogram 3.x bilan yozish" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2M7.5 13A2.5 2.5 0 0 0 5 15.5 2.5 2.5 0 0 0 7.5 18a2.5 2.5 0 0 0 2.5-2.5A2.5 2.5 0 0 0 7.5 13m9 0a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Telegram botlarini aiogram 3.x bilan yozish
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Aiogram bilan tanishish
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Qidirish" placeholder="Qidirish" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Qidirish">
        
        <button type="reset" class="md-search__icon md-icon" title="Tozalash" aria-label="Tozalash" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Qidiruv ishga tushirilmoqda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MasterGroosha/aiogram-3-guide" title="Repozitoriyga o'tish" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    MasterGroosha/aiogram-3-guide
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<!-- Determine classes -->




<!-- Navigation -->
<nav
  class="md-nav md-nav--primary"
  aria-label="Navigatsiya"
  data-md-level="0"
>

  <!-- Site title -->
  <label class="md-nav__title" for="__drawer">
    <a
      href=".."
      title="Telegram botlarini aiogram 3.x bilan yozish"
      class="md-nav__button md-logo"
      aria-label="Telegram botlarini aiogram 3.x bilan yozish"
      data-md-component="logo"
    >
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2M7.5 13A2.5 2.5 0 0 0 5 15.5 2.5 2.5 0 0 0 7.5 18a2.5 2.5 0 0 0 2.5-2.5A2.5 2.5 0 0 0 7.5 13m9 0a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5Z"/></svg>

    </a>
    Mundarija
  </label>

  <!-- Repository information -->
  
    <div class="md-nav__source">
      <a href="https://github.com/MasterGroosha/aiogram-3-guide" title="Repozitoriyga o'tish" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    MasterGroosha/aiogram-3-guide
  </div>
</a>
    </div>
  

  <!-- Navigation list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kirish
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Aiogram bilan tanishish
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Aiogram bilan tanishish
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Mundarija">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Mundarija
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    <span class="md-ellipsis">
      Terminologiya
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      O'rnatish
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    <span class="md-ellipsis">
      Birinchi bot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sugar" class="md-nav__link">
    <span class="md-ellipsis">
      Sintaktik shakar (syntactic sugar)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pass-extras" class="md-nav__link">
    <span class="md-ellipsis">
      Qo'shimcha parametrlarni uzatish
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#konfiguratsiya-fayllari" class="md-nav__link">
    <span class="md-ellipsis">
      Konfiguratsiya fayllari
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../messages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xabarlar bilan ishlash
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../buttons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tugmalar
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../routers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Routerlar. Tuzilma
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../filters-and-middlewares/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filtrlar va middlewarelar
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../special-updates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maxsus yangilanishlar
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Holat mashinalari
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inline-mode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inline-rejim
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../payments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    To‘lovlar
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced-teaser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🔒 Yuqori daraja
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Mundarija">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Mundarija
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    <span class="md-ellipsis">
      Terminologiya
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      O'rnatish
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    <span class="md-ellipsis">
      Birinchi bot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sugar" class="md-nav__link">
    <span class="md-ellipsis">
      Sintaktik shakar (syntactic sugar)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pass-extras" class="md-nav__link">
    <span class="md-ellipsis">
      Qo'shimcha parametrlarni uzatish
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#konfiguratsiya-fayllari" class="md-nav__link">
    <span class="md-ellipsis">
      Konfiguratsiya fayllari
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><h1 id="aiogram-bilan-tanishish">Aiogram bilan tanishish<a class="headerlink" href="#aiogram-bilan-tanishish" title="Permanent link">¶</a></h1>
<div class="admonition info">
<p>Foydalanilayotgan aiogram versiyasi: 3.7.0</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Ba'zi tafsilotlar ataylab soddalashtirilgan!</p>
<p>Ushbu kitob muallifi, nazariyadan tashqari amaliyot ham bo'lishi kerak deb hisoblaydi.
Keyingi keltirilgan kodni maksimal darajada sodda qilib qayta yaratish uchun, 
faqat mahalliy rivojlantirish va o'qitishga mos keladigan yondashuvlardan foydalanishga to'g'ri keldi.</p>
<p>Shunday qilib, masalan, barcha yoki deyarli barcha bo'limlarda bot tokeni dastur kodida ko'rsatiladi. 
Bu <strong>yomon</strong> yondashuv, chunki agar kodni ommaviy repozitoriyga (masalan, GitHub) yuklashdan oldin uni o'chirishni unutib qo'ysangiz, 
tokenning oshkor bo'lishiga olib kelishi mumkin.</p>
<p>Yoki ba'zida ma'lumotlar ombori sifatida faqat operativ xotirada joylashgan tuzilmalar (lug'atlar, ro'yxatlar ...) ishlatiladi. 
Aslida bunday qilish to'g'ri hisoblanmaydi, chunki bot to'xtatilganda ma'lumotlar tiklanmaydi va yo'qolishiga olib keladi.</p>
<p>Shuningdek, Telegramdan yangilanishlarni olish mexanizmi sifatida polling tanlangan, 
chunki u deyarli barcha muhitlarda ishonchli ishlaydi va deyarli barcha ishlab chiquvchilarga mos keladi.</p>
<p><strong>Muhim esda tuting, muallifning maqsadi aiogram yordamida aynan Telegram Bot API bilan ishlashni tushuntirish, 
va umuman olganda butun kompyuter fanlarini tushuntirish emas.</strong></p>
</div>
<h2 id="glossary">Terminologiya<a class="headerlink" href="#glossary" title="Permanent link">¶</a></h2>
<p>Bir xil terminlardan foydalanish uchun ularni kelishib olamiz va bu keyinchalik chalkashishning oldini oladi:</p>
<ul>
<li>Shaxsiy — shaxsiy xabarlar, bot holatida bu foydalanuvchi bilan botning birga-yakka muloqoti, guruh/kanal emas.</li>
<li>Chat — shaxsiy, guruhlar, superguruhlar va kanallarning umumiy nomi.</li>
<li>Update — <a href="https://core.telegram.org/bots/api#update">ushbu</a> ro'yxatdagi har qanday hodisa: xabar, xabarni tahrirlash, callback, inline-so'rov, to'lov, botni guruhga qo'shish va h.k.</li>
<li>Handler — dispatcherdan/routerdan navbatdagi update-ni qabul qilib, uni qayta ishlaydigan asinxron funksiya.</li>
<li>Dispatcher — Telegramdan yangilanishlarni qabul qilish va keyingi qayta ishlash uchun mos handlerga uzatish bilan shug'ullanadigan ob'ekt.</li>
<li>Router — dispatcherga o'xshash, lekin handlerlar to'plamining kichik to'plamiga javob beradi. Dispatcherni asos router deb atash mumkin.</li>
<li>Filter — odatda True yoki False qaytaradigan va handler chaqirilishi yoki chaqirilmasligiga ta'sir qiladigan ifoda.</li>
<li>Middleware — updatelardan kelgan ma'lumotlarni qabul qilish va handlerga yetmasdan qayta ishlash uchun qo'shiladigan 'qatlam'.</li>
</ul>
<h2 id="installation">O'rnatish<a class="headerlink" href="#installation" title="Permanent link">¶</a></h2>
<p>Avvalo bot uchun papka ochamiz, u yerda virtual environment (venv)'ni yaratamiz va 
<a href="https://github.com/aiogram/aiogram">aiogram</a> kutubxonasini o‘rnatamiz.
Python 3.9 versiyasi o‘rnatilganligini tekshiramiz (agar sizda 3.9 va undan yuqori versiya o‘rnatilgan bo'lsa, ushbu bo‘limni o‘tkazib yuborishingiz mumkin):</p>
<div class="highlight"><pre><span></span><code>[groosha@main lesson_01]$ python3.9
Python 3.9.9 (main, Jan 11 2022, 16:35:07) 
[GCC 11.1.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; exit()
[groosha@main lesson_01]$ 
</code></pre></div>
<p>Endi <code>requirements.txt</code> faylini yaratamiz, unda biz foydalanadigan aiogram versiyasini ko'rsatamiz. 
Shuningdek, konfiguratsiya fayllari uchun pydantic-settings kutubxonasi ham kerak bo'ladi.</p>
<div class="admonition important">
<p class="admonition-title">Aiogram versiyalari haqida</p>
<p>Ushbu bo'limda aiogram <strong>3.x</strong> ishlatiladi, ishni boshlashdan oldin kutubxonaning 
<a href="https://t.me/aiogram_live">yangiliklar kanali</a>ga kirib, yangi versiyaning mavjudligini tekshirishni tavsiya qilaman. 
3 raqami bilan boshlanadigan har qanday yangi versiya bilan ishlashinggiz mumkin, chunki aiogram 2.x versiyasi yangilanmaydi va eskirgan deb hisoblanadi.</p>
</div>
<div class="highlight"><pre><span></span><code>[groosha@main 01_quickstart]$ python3.11 -m venv venv
[groosha@main 01_quickstart]$ echo "aiogram&lt;4.0" &gt; requirements.txt
[groosha@main 01_quickstart]$ echo "pydantic-settings" &gt;&gt; requirements.txt
[groosha@main 01_quickstart]$ source venv/bin/activate
(venv) [groosha@main 01_quickstart]$ pip install -r requirements.txt 
# ...bu yerda o'rnatish haqida ko'plab yozuvlar chiqadi...
Successfully installed ...shunga o'xshash...
[groosha@main 01_quickstart]$
</code></pre></div>
<p>Обратите внимание на префикс "venv" в терминале. Он указывает, что мы находимся в виртуальном окружении с именем "venv".
Проверим, что внутри venv вызов команды <code>python</code> указывает на всё тот же Python 3.11: </p>
<p>Terminaldagi "venv" boshmatniga e'tibor bering. Bu bizning "venv" deb nomlangan virtual muhit ichida ekanligimizni bildiradi.
Keling, venv ichida "python" buyrug'iga yozib uning ishga tushishini tekshirib ko'ramiz:
</p><div class="highlight"><pre><span></span><code>(venv) [groosha@main 01_quickstart]$ python
Python 3.11.9 (main, Jan 11 2024, 16:35:07) 
[GCC 11.1.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; exit()
(venv) [groosha@main 01_quickstart]$ deactivate 
[groosha@main 01_quickstart]$ 
</code></pre></div>
<p>Muhit bizga xalaqit bermasligi uchun <code>deactivate</code> buyrug'ini bilan venv'dan chiqishimiz mumkin.</p>
<div class="admonition info">
<p>Agar siz botlarni yozish uchun PyCharm'dan foydalanayotgan bo'lsangiz, 
Telegram ob'ektlarida kodni avtomatik to‘ldirishni qo‘llash uchun 
<a href="https://plugins.jetbrains.com/plugin/12861-pydantic">Pydantic</a>'ning uchinchi tomon plaginini o'rnatishni ham tavsiya qilaman.</p>
</div>
<h2 id="hello-world">Birinchi bot<a class="headerlink" href="#hello-world" title="Permanent link">¶</a></h2>
<p>Keling, aiogram asosiy shabloniga ega bot.py faylini yarataylik:
</p><div class="highlight"><span class="filename">bot.py</span><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">aiogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bot</span><span class="p">,</span> <span class="n">Dispatcher</span><span class="p">,</span> <span class="n">types</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">aiogram.filters.command</span><span class="w"> </span><span class="kn">import</span> <span class="n">Command</span>

<span class="c1"># Muhim xabarlarni o'tkazib yubormaslik uchun loglashni yoqamiz</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="c1"># Bot obyektini yaratamiz</span>
<span class="n">bot</span> <span class="o">=</span> <span class="n">Bot</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s2">"12345678:AaBbCcDdEeFfGgHh"</span><span class="p">)</span>
<span class="c1"># Dispatcher obyektini yaratamiz</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">Dispatcher</span><span class="p">()</span>

<span class="c1"># /start buyrug'iga uchun handler</span>
<span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"start"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_start</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="s2">"Hello!"</span><span class="p">)</span>

<span class="c1"># Yangi update'larni olish uchun polling jarayonini boshlaymiz</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">dp</span><span class="o">.</span><span class="n">start_polling</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<p>Birinchi navbatda e'tibor qaratishingiz kerak bo'lgan narsa: aiogram asinxron kutubxona hisoblanadi, 
shuning uchun handlerlaringiz ham asinxron bo'lishi kerak. API metodlarini chaqirishdan oldin <strong>await</strong> kalit so'zini qo'yish kerak, chunki bu chaqiriqlar <a href="https://docs.python.org/3/library/asyncio-task.html#coroutines">korutin</a>larni qaytaradi.</p>
<div class="admonition info">
<p class="admonition-title">Python’da asinxron dasturlash</p>
<p>Rasmiy hujjatlarni e'tiborsiz qoldirmang!
<a href="https://docs.python.org/3/library/asyncio-task.html">Python saytida</a> ajoyib asyncio qo'llanmasi mavjud.</p>
</div>
<p>Agar siz ilgari Telegram uchun boshqa biror boshqa kutubxona, masalan pyTelegramBotAPI bilan ishlagan bo'lsangiz, 
handler'larni tushuningizda qiyinlik tug'ilmaydi. Farqi shundaki, aiogramda handlerlarni dispatcher boshqaradi.
Dispatcher funksiya-handlerlarni ro'yxatdan o'tkazadi va ularni chaqiruvchi hodisalar ro'yxatini filtrlardan foydalanib qo'shimcha cheklaydi. 
Telegramdan navbatdagi yangilanish (update) qabul qilingandan so'ng, dispatcher barcha filtrlar bo'yicha mos keladigan kerakli qayta ishlash funksiyasini tanlaydi. 
Agar ikki funksiya mantiqiy jihatdan bir xil filtrlarga ega bo'lsa, avvalroq ro'yxatdan o'tkazilgan funksiya chaqiriladi.</p>
<p>Funksiyani xabarlarni qayta ishlovchi sifatida ro'yxatdan o'tkazish uchun quyidagi ikki amaldan birini bajarish kerak:<br>
1. Uni yuqoridagi misoldagi kabi <a href="https://telegra.ph/Pythonda-decoratorlar-03-29">dekorator</a> bilan yozish. 
Turli xil dekoratorlar bilan keyinchalik tanishamiz.<br>
2. Dispatcher yoki routerda ro'yxatdan o'tkazish(register) metodini to'g'ridan-to'g'ri chaqirish.</p>
<p>Quyidagi kodni ko'rib chiqamiz:
</p><div class="highlight"><pre><span></span><code><span class="c1"># /test1 buyrug'iga uchun handler</span>
<span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"test1"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_test1</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span><span class="s2">"Test 1"</span><span class="p">)</span>

<span class="c1"># /test2 buyrug'iga uchun handler</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_test2</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span><span class="s2">"Test 2"</span><span class="p">)</span>
</code></pre></div>
<p>Keling, botning ushbu kodini ishga tushiramiz:
<img alt="Команда /test2 не работает" src="../images/quickstart/l01_1.jpg"></p>
<p><code>cmd_test2</code> handleri ishlamaydi, chunki dispatcher undan xabardor emas. 
Bu xatoni to'g'rilaymiz va funksiyani alohida ro'yxatdan o'tkazamiz:
</p><div class="highlight"><pre><span></span><code><span class="c1"># Хэндлер на команду /test2</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_test2</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span><span class="s2">"Test 2"</span><span class="p">)</span>

<span class="c1"># Где-то в другом месте, например, в функции main():</span>
<span class="n">dp</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cmd_test2</span><span class="p">,</span> <span class="n">Command</span><span class="p">(</span><span class="s2">"test2"</span><span class="p">))</span>
</code></pre></div>
<p>Botni yangidan ishga tushiramiz:<br>
<img alt="Обе команды работают" src="../images/quickstart/l01_2.jpg"></p>
<h2 id="sugar">Sintaktik shakar (syntactic sugar)<a class="headerlink" href="#sugar" title="Permanent link">¶</a></h2>
<p>Kodni toza va o'qilishi osonroq qilish uchun aiogram Telegramning standart obyektlarining imkoniyatlarini kengaytiradi. 
Masalan, <code>bot.send_message(...)</code> o'rniga <code>message.answer(...)</code> yoki <code>message.reply(...)</code> deb yozish mumkin. 
Oxirgi ikki holatda <code>chat_id</code>ni ko'rsatish shart emas, chunki u dastlabki xabardagi kabi bo'ladi.
<code>answer</code> va <code>reply</code> orasidagi farq oddiy: birinchi metod shunchaki xabarni shu chatga yuboradi, 
ikkinchisi esa <code>message</code>dan xabariga "javob" qiladi (bu holatda bot jo'natgan habar sizning habaringgizga bog'langan bo'ladi):
</p><div class="highlight"><pre><span></span><code><span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"answer"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_answer</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="s2">"Bu oddiy xabar"</span><span class="p">)</span>


<span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"reply"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_reply</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span><span class="s1">'Bu "javob" xabari'</span><span class="p">)</span>
</code></pre></div>
<img alt="message.answer() va message.reply() orasidagi farq" src="../images/quickstart/l01_3.jpg">
<p>Bundan tashqari, xabarlarning ko'p turlari uchun 
"answer_{type}" yoki "reply_{type}" shaklidagi yordamchi metodlar mavjud, masalan:
</p><div class="highlight"><pre><span></span><code><span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"dice"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_dice</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">answer_dice</span><span class="p">(</span><span class="n">emoji</span><span class="o">=</span><span class="s2">"🎲"</span><span class="p">)</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title"><code>message: types.Message</code> qanday ma'noni bildiradi?</p>
<p>Python <a href="https://realpython.com/lessons/dynamic-vs-static/">kuchli dinamik tiplashgan</a> interpretatsiyalanuvchi til bo'lib, 
C++ yoki Java kabi ichki tip tekshiruvi mavjud emas. Biroq, 3.5-versiyasidan boshlab, 
tilga tip ko'rsatmalarini qo'llab-quvvatlash qo'shildi, bu esa turli tekshiruvlar va PyCharm kabi IDE’lar ishlatilayotgan 
qiymatlarning turlarini tahlil qilib, dasturchiga noto'g'ri narsa uzatilsa xabar berish imkonini beradi. 
Bu holatda <code>types.Message</code> matni PyCharm'ga <code>message</code> o'zgaruvchisi aiogram kutubxonasining <code>types</code> modulida tavsiflangan 
<code>Message</code> turiga ega ekanligini bildiradi (kodingiz boshidagi importlarga qarang). 
Bu orqali IDE atributlar va funksiyalarni ko'rsatib turishi mumkin.</p>
</div>
<p><code>/dice</code> buyrug'i yuborilganda, bot shu chatga o'yin kubigini yuboradi. Albatta, agar uni boshqa chatga yuborish kerak bo'lsa, 
odatdagidek await <code>bot.send_dice(...)</code>ni chaqirishga to'g'ri keladi. Lekin <code>bot</code> obyekti (<code>Bot</code> sinfining nusxasi) ma'lum bir 
funksiyaning ko'rinishida mavjud bo'lmasligi mumkin. aiogram 3.x da yangilanish kelganda kutubxona bot obyekti aniq bo'lmagan holda 
handlerga uzatiladi va uni bot argumenti sifatida olish mumkin. Faraz qilaylik, siz <code>/dice</code> buyrug'i bilan kubikni shu 
chatga emas, balki ID -100123456789 bo'lgan kanalga yubormoqchisiz. Oldingi funksiyani quyidagicha qayta yozamiz:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># import qilishni unutmang</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">aiogram.enums.dice_emoji</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiceEmoji</span>

<span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"dice"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_dice</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">Bot</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">bot</span><span class="o">.</span><span class="n">send_dice</span><span class="p">(</span><span class="o">-</span><span class="mi">100123456789</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">DiceEmoji</span><span class="o">.</span><span class="n">DICE</span><span class="p">)</span>
</code></pre></div>
<h2 id="pass-extras">Qo'shimcha parametrlarni uzatish<a class="headerlink" href="#pass-extras" title="Permanent link">¶</a></h2>
<p>Ba'zida botni ishga tushirganda bir yoki bir nechta qo'shimcha qiymatlarni uzatish kerak bo'lishi mumkin. 
Bu qandaydir o'zgaruvchi, konfiguratsiya obyekti, biror narsalar ro'yxati va boshqa narsalar bo'lishi mumkin. 
Buning uchun bu ma'lumotlarni (kwargs) argumentlar sifatida dispatcherga uzatish yoki lug'at bilan ishlayotgandek 
qiymatlarni belgilash kifoya.</p>
<p>Bunday imkoniyat yagona nusxada bo'lishi va bot ishlayotgan paytda o'zgarmasligi kerak bo'lgan obyektlarni uzatish uchun 
eng mos keladi (ya'ni, faqat o'qish uchun). Agar qiymat vaqt o'tishi bilan o'zgarishi kerak bo'lsa, 
bu faqat <a href="https://mathspp.com/blog/pydonts/pass-by-value-reference-and-assignmen">o'zgaruvchan obyektlar</a> bilan ishlaydi. 
Handlerlarda qiymatlarni olish uchun ularni oddiygina argumentlar sifatida ko'rsating. Misol orqali ko'rib chiqamiz:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Boshqa joyda</span>
<span class="c1"># Masalan, ilovaning kirish nuqtasida</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># bot = ...</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">Dispatcher</span><span class="p">()</span>
<span class="n">dp</span><span class="p">[</span><span class="s2">"started_at"</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M"</span><span class="p">)</span>
<span class="k">await</span> <span class="n">dp</span><span class="o">.</span><span class="n">start_polling</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">mylist</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>


<span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"add_to_list"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_add_to_list</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">mylist</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="n">mylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="s2">"7 raqa qo'shildi"</span><span class="p">)</span>


<span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"show_list"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_show_list</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">mylist</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Sizning ro'yxatinggiz: </span><span class="si">{</span><span class="n">mylist</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>


<span class="nd">@dp</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">Command</span><span class="p">(</span><span class="s2">"info"</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cmd_info</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">started_at</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Bot ishga tushirildi </span><span class="si">{</span><span class="n">started_at</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<p>Endi started_at o'zgaruvchisi va mylist ro'yxatini turli handlerlarda o'qish va yozish mumkin. Agar har bir yangilanish 
uchun noyob qiymatlarni (masalan, DBMS sessiya obyektini) uzatishingiz kerak bo'lsa, 
<a href="../filters-and-middlewares/#middlewares">middleware</a>lar bilan tanishing.</p>
<p><img alt="mylist argumenti chaqiruvlar orasida o'zgartirilishi mumkin" src="../images/quickstart/extra-args.png"></p>
<h2 id="konfiguratsiya-fayllari">Konfiguratsiya fayllari<a class="headerlink" href="#konfiguratsiya-fayllari" title="Permanent link">¶</a></h2>
<p>Tokenni to'g'ridan-to'g'ri kodda saqlamaslik uchun (agar siz botingizni ommaviy repozitoriyga yuklamoqchi bo'lsangiz?) 
bunday ma'lumotlarni alohida konfiguratsiya fayliga chiqarishingiz mumkin. Bu haqida rus tilidagi <a href="https://t.me/advice17/26">maqola</a> majud, 
Kod yozayotganinggizda environment o'zgaruvchilarini o'zgartirishnggiz kifoya, ammo ushbu kitob doirasida biz <code>.env</code> fayllaridan foydalanamiz,
bu kodlarimizni biroz soddalashtiradi va bu kitob foydalanuvchilariga loyihani ko'rsatishda yordam beradi.</p>
<p>Shunday qilib, <code>bot.py</code> yonida quyidagi ko'rinishdagi <code>config_reader.py</code> nomli alohida fayl yaratamiz:</p>
<div class="highlight"><span class="filename">config_reader.py</span><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic_settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseSettings</span><span class="p">,</span> <span class="n">SettingsConfigDict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">SecretStr</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Settings</span><span class="p">(</span><span class="n">BaseSettings</span><span class="p">):</span>
    <span class="c1"># Maxfiy ma'lumotlar uchun, masalan, bot tokeni uchun </span>
    <span class="c1"># str o'rniga SecretStr ishlatish tavsiya etiladi</span>
    <span class="n">bot_token</span><span class="p">:</span> <span class="n">SecretStr</span>

    <span class="c1"># Pydanticning ikkinchi versiyasidan boshlab, sozlamalar klassining sozlamalari </span>
    <span class="c1"># model_config orqali belgilanadi</span>
    <span class="c1"># Bu holda UTF-8 kodlash bilan o'qiladigan .env fayli ishlatiladi</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">SettingsConfigDict</span><span class="p">(</span><span class="n">env_file</span><span class="o">=</span><span class="s1">'.env'</span><span class="p">,</span> <span class="n">env_file_encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span>


<span class="c1"># Fayl import qilinganda darhol </span>
<span class="c1"># konfiguratsiya obyekti yaratiladi va tasdiqlanadi,</span>
<span class="c1"># keyinchalik uni turli joylardan import qilish mumkin</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
</code></pre></div>
<p>Endi <code>bot.py</code> faylimizni biroz tahrir qilamiz:</p>
<div class="highlight"><span class="filename">bot.py</span><pre><span></span><code><span class="c1"># import</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">config_reader</span><span class="w"> </span><span class="kn">import</span> <span class="n">config</span>

<span class="c1"># Secret* turi bo'lgan yozuvlar uchun </span>
<span class="c1"># haqiqiy mazmunni olish uchun get_secret_value() metodini chaqirish kerak, </span>
<span class="c1"># aks holda '*******' ko'rsatiladi</span>
<span class="n">bot</span> <span class="o">=</span> <span class="n">Bot</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">bot_token</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">())</span>
</code></pre></div>
<p>Oxirida, <code>.env</code> (boshida nuqta bilan) faylini yaratamiz va unda bot tokenini yozamiz:
</p><div class="highlight"><span class="filename">.env</span><pre><span></span><code>BOT_TOKEN = 0000000000:AaBbCcDdEeFfGgHhIiJjKkLlMmNn
</code></pre></div>
<p>Agar hammasi to'g'ri qilingan bo'lsa, python-dotenv <code>.env</code> faylidagi o'zgaruvchilarni yuklaydi, pydantic 
ularni tasdiqlaydi va bot obyekti kerakli token bilan muvaffaqiyatli yaratiladi.</p>
<p>Shu bilan biz kutubxona bilan tanishishni yakunlaymiz, keyingi bo'limlarda aiogram va Telegram Bot API ning boshqa "foydali funksiyalar"ini ko'rib chiqamiz.</p></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020-2024 Groosha
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://t.me/+DE0_2nCvbXozZjUy" target="_blank" rel="noopener" title="Чат в Telegram" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/MasterGroosha/aiogram-3-guide" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Buferga nusxalandi", "clipboard.copy": "Buferga nusxalash", "search.result.more.one": "Ushbu sahifada yana 1 ta natija", "search.result.more.other": "Bu sahifada yana # ta natija", "search.result.none": "Mos natijalar yo\u0027q", "search.result.one": "1 ta mos natija", "search.result.other": "# ta mos keladigan natijalar", "search.result.placeholder": "Qidiruvni boshlash uchun kiriting", "search.result.term.missing": "To\u0027ldirilmagan", "select.version": "Versiyani tanlang"}}</script>
    
    
      <script src="../assets/javascripts/bundle.081f42fc.min.js"></script>
      
    
  </body>
</html>